{"ast":null,"code":"import _regeneratorRuntime from\"/home/serban/Desktop/bytes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/serban/Desktop/bytes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/serban/Desktop/bytes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/serban/Desktop/bytes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useEffect,useState}from\"react\";import{API,graphqlOperation,strike}from\"aws-amplify\";import{v4 as uuidv4}from\"uuid\";import{listBytes}from\"../api/queries\";import{updateByte,processOrder}from\"../api/mutations\";var ByteContext=/*#__PURE__*/React.createContext();var ByteProvider=function ByteProvider(_ref){var children=_ref.children;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),bytes=_useState2[0],setBytes=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];useEffect(function(){fetchBytes();},[]);var checkout=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(orderDetails){var payload;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:payload=_objectSpread({id:uuidv4()},orderDetails);_context.prev=1;_context.next=4;return API.graphql(graphqlOperation(processOrder,{input:payload}));case 4:console.log(\"Order is successful\");_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[1,7]]);}));return function checkout(_x){return _ref2.apply(this,arguments);};}();var fetchBytes=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$API$graphql,data,_bytes;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setLoading(true);// Switch authMode to API_KEY for public access\n_context2.next=4;return API.graphql({query:listBytes,authMode:\"API_KEY\"});case 4:_yield$API$graphql=_context2.sent;data=_yield$API$graphql.data;_bytes=data.listBytes.items;setBytes(_bytes);setLoading(false);_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11]]);}));return function fetchBytes(){return _ref3.apply(this,arguments);};}();var toggleBit=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(byte,customer){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return API.graphql(graphqlOperation(updateByte,{input:{id:byte.id,index:byte.index,content:(1-parseInt(byte.content)).toString(),owner:customer}}));case 3:console.log(\"toggle is successful\");_context3.next=9;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 9:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function toggleBit(_x2,_x3){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsx(ByteContext.Provider,{value:{bytes:bytes,loading:loading,checkout:checkout,toggleBit:toggleBit},children:children});};export{ByteContext,ByteProvider};","map":{"version":3,"sources":["/home/serban/Desktop/bytes/src/context/bytes.js"],"names":["React","useEffect","useState","API","graphqlOperation","strike","v4","uuidv4","listBytes","updateByte","processOrder","ByteContext","createContext","ByteProvider","children","bytes","setBytes","loading","setLoading","fetchBytes","checkout","orderDetails","payload","id","graphql","input","console","log","query","authMode","data","items","toggleBit","byte","customer","index","content","parseInt","toString","owner"],"mappings":"2mBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,GAAT,CAAcC,gBAAd,CAAgCC,MAAhC,KAA8C,aAA9C,CACA,OAASC,EAAE,GAAIC,CAAAA,MAAf,KAA6B,MAA7B,CACA,OAASC,SAAT,KAA0B,gBAA1B,CACA,OAASC,UAAT,CAAqBC,YAArB,KAAyC,kBAAzC,CAEA,GAAMC,CAAAA,WAAW,cAAGX,KAAK,CAACY,aAAN,EAApB,CAEA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAkB,IAAfC,CAAAA,QAAe,MAAfA,QAAe,eACXZ,QAAQ,CAAC,EAAD,CADG,wCAC9Ba,KAD8B,eACvBC,QADuB,8BAEPd,QAAQ,CAAC,KAAD,CAFD,yCAE9Be,OAF8B,eAErBC,UAFqB,eAIrCjB,SAAS,CAAC,UAAM,CACdkB,UAAU,GACX,CAFQ,CAEN,EAFM,CAAT,CAIA,GAAMC,CAAAA,QAAQ,2FAAG,iBAAOC,YAAP,8HACTC,OADS,gBAEbC,EAAE,CAAEhB,MAAM,EAFG,EAGVc,YAHU,wCAMPlB,CAAAA,GAAG,CAACqB,OAAJ,CAAYpB,gBAAgB,CAACM,YAAD,CAAe,CAAEe,KAAK,CAAEH,OAAT,CAAf,CAA5B,CANO,QAObI,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAPa,+EASbD,OAAO,CAACC,GAAR,cATa,oEAAH,kBAARP,CAAAA,QAAQ,6CAAd,CAaA,GAAMD,CAAAA,UAAU,2FAAG,4LAEfD,UAAU,CAAC,IAAD,CAAV,CACA;AAHe,uBAIQf,CAAAA,GAAG,CAACqB,OAAJ,CAAY,CACjCI,KAAK,CAAEpB,SAD0B,CAEjCqB,QAAQ,CAAE,SAFuB,CAAZ,CAJR,0CAIPC,IAJO,oBAIPA,IAJO,CAQTf,MARS,CAQDe,IAAI,CAACtB,SAAL,CAAeuB,KARd,CASff,QAAQ,CAACD,MAAD,CAAR,CACAG,UAAU,CAAC,KAAD,CAAV,CAVe,qFAYfQ,OAAO,CAACC,GAAR,eAZe,uEAAH,kBAAVR,CAAAA,UAAU,2CAAhB,CAgBA,GAAMa,CAAAA,SAAS,2FAAG,kBAAOC,IAAP,CAAaC,QAAb,8JAER/B,CAAAA,GAAG,CAACqB,OAAJ,CAAYpB,gBAAgB,CAACK,UAAD,CAAa,CAAEgB,KAAK,CAAE,CAACF,EAAE,CAAEU,IAAI,CAACV,EAAV,CAAcY,KAAK,CAAEF,IAAI,CAACE,KAA1B,CAAiCC,OAAO,CAAE,CAAC,EAAEC,QAAQ,CAACJ,IAAI,CAACG,OAAN,CAAX,EAA2BE,QAA3B,EAA1C,CAAiFC,KAAK,CAAEL,QAAxF,CAAT,CAAb,CAA5B,CAFQ,QAGdR,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAHc,kFAKdD,OAAO,CAACC,GAAR,eALc,qEAAH,kBAATK,CAAAA,SAAS,kDAAf,CASA,mBACE,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAE,CAAEjB,KAAK,CAALA,KAAF,CAASE,OAAO,CAAPA,OAAT,CAAkBG,QAAQ,CAARA,QAAlB,CAA4BY,SAAS,CAATA,SAA5B,CAA7B,UACGlB,QADH,EADF,CAKD,CAnDD,CAqDA,OAASH,WAAT,CAAsBE,YAAtB","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { API, graphqlOperation, strike } from \"aws-amplify\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { listBytes } from \"../api/queries\";\nimport { updateByte, processOrder } from \"../api/mutations\";\n\nconst ByteContext = React.createContext();\n\nconst ByteProvider = ({ children }) => {\n  const [bytes, setBytes] = useState([]);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    fetchBytes();\n  }, []);\n\n  const checkout = async (orderDetails) => {\n    const payload = {\n      id: uuidv4(),\n      ...orderDetails\n    };\n    try {\n      await API.graphql(graphqlOperation(processOrder, { input: payload }));\n      console.log(\"Order is successful\");\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const fetchBytes = async () => {\n    try {\n      setLoading(true);\n      // Switch authMode to API_KEY for public access\n      const { data } = await API.graphql({\n        query: listBytes,\n        authMode: \"API_KEY\"\n      });\n      const bytes = data.listBytes.items;\n      setBytes(bytes);\n      setLoading(false);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const toggleBit = async (byte, customer) => {\n    try {\n      await API.graphql(graphqlOperation(updateByte, { input: {id: byte.id, index: byte.index, content: (1-parseInt(byte.content)).toString(), owner: customer} }));\n      console.log(\"toggle is successful\");\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return (\n    <ByteContext.Provider value={{ bytes, loading, checkout, toggleBit }}>\n      {children}\n    </ByteContext.Provider>\n  );\n};\n\nexport { ByteContext, ByteProvider };\n"]},"metadata":{},"sourceType":"module"}